{% extends "layout.html" %}

{% block title %}Рынок{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/market.css">
{% endblock %}

{% block content %}
<div class="content-header">
    <h1>Рынок</h1>
</div>

<div class="market-accordion" id="marketAccordion">
    <div class="accordion-item">
        <button class="accordion-header" data-target="stocks">
            <span>Акции</span>
            <span class="accordion-arrow">▼</span>
        </button>
        <div class="accordion-content" id="stocks">
            <div class="assets-list">
                {% if stocks %}
                    {% for stock in stocks %}
                    <div class="stock-card">
                        <div class="stock-info">
                            <div>
                                <h3 class="stock-name">{{ stock.name }}</h3>
                                <p class="stock-ticker">{{ stock.ticker }}</p>
                                {% if stock.full_name %}
                                <p class="stock-fullname">{{ stock.full_name|truncate(60) }}</p>
                                {% endif %}
                            </div>
                            <div class="price-section">
                                <div class="stock-price">
                                    {% if stock.price > 0 %}
                                        {{ "%.2f"|format(stock.price) }} руб.
                                    {% else %}
                                        Нет данных
                                    {% endif %}
                                </div>
                                <div class="stock-change 
                                    {% if stock.change > 0 %}positive
                                    {% elif stock.change < 0 %}negative{% endif %}">
                                    {% if stock.change > 0 %}+{% endif %}
                                    {% if stock.change != 0 %}
                                        {{ "%.2f"|format(stock.change) }} руб.
                                    {% else %}
                                        0.00 руб.
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="no-data">
                        <p>Не удалось загрузить данные по акциям</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="accordion-item">
        <button class="accordion-header" data-target="bonds">
            <span>Облигации</span>
            <span class="accordion-arrow">▼</span>
        </button>
        <div class="accordion-content" id="bonds">
            <div class="assets-list">
                <div class="no-data">
                    <p>Данные по облигациям будут добавлены позже</p>
                </div>
            </div>
        </div>
    </div>

    <div class="accordion-item">
        <button class="accordion-header" data-target="funds">
            <span>Фонды</span>
            <span class="accordion-arrow">▼</span>
        </button>
        <div class="accordion-content" id="funds">
            <div class="assets-list">
                <div class="no-data">
                    <p>Данные по фондам будут добавлены позже</p>
                </div>
            </div>
        </div>
    </div>

    <div class="accordion-item">
        <button class="accordion-header" data-target="currency">
            <span>Валюта</span>
            <span class="accordion-arrow">▼</span>
        </button>
        <div class="accordion-content" id="currency">
            <div class="assets-list">
                <div class="no-data">
                    <p>Данные по валюте будут добавлены позже</p>
                </div>
            </div>
        </div>
    </div>

    <div class="accordion-item">
        <button class="accordion-header" data-target="indices">
            <span>Индексы</span>
            <span class="accordion-arrow">▼</span>
        </button>
        <div class="accordion-content" id="indices">
            <div class="assets-list">
                <div class="no-data">
                    <p>Данные по индексам будут добавлены позже</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="/static/js/market.js"></script>
{% endblock %}